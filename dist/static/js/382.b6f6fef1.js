"use strict";(self["webpackChunkmine_live_web"]=self["webpackChunkmine_live_web"]||[]).push([[382],{1631:function(e,t,n){n.d(t,{A:function(){return i},F:function(){return o}});n(4114);var a=n(5098);const o="https://api.minelive.top";function i(){const e=localStorage.getItem("userToken");if(e)return e;a.A.push("/?login=1")}},5324:function(e,t,n){n.d(t,{A:function(){return o}});n(4114);var a=n(5098);function o(){const e=localStorage.getItem("userAdmin");if(e&&"true"===e){const e=document.createElement("mdui-navigation-rail-item");e.icon="manage_accounts",e.addEventListener("click",(function(){a.A.push("/admin")})),e.innerHTML="管理",document.getElementById("rail").appendChild(e)}}},9382:function(e,t,n){n.r(t),n.d(t,{default:function(){return _}});var a=n(6768);const o=(0,a.Lk)("div",{style:{"margin-left":"80px"}},null,-1),i=(0,a.Lk)("img",{src:"https://s21.ax1x.com/2024/04/07/pFq2AoR.png",alt:"alternative",style:{width:"2.5rem",height:"2.5rem"}},null,-1),l=(0,a.Lk)("input",{type:"file",id:"fileInput",style:{display:"none"}},null,-1),r=(0,a.Lk)("div",{style:{"margin-left":"1px"}},null,-1),d=(0,a.Lk)("table",{class:"mdui-table mdui-table-striped"},[(0,a.Lk)("thead",null,[(0,a.Lk)("tr",null,[(0,a.Lk)("th",null,"名称"),(0,a.Lk)("th",null,"类型"),(0,a.Lk)("th",null,"上传时间"),(0,a.Lk)("th",null,"大小"),(0,a.Lk)("th",null,"操作")])]),(0,a.Lk)("tbody",{id:"material-list-tbody"})],-1),c=(0,a.Lk)("p",null,[(0,a.eW)("文件大小 < 120M"),(0,a.Lk)("br"),(0,a.eW)("支持格式 .mp4 .png .jpg"),(0,a.Lk)("br"),(0,a.eW)("1080p及以上视频分辨率")],-1);function u(e,t,n,u,s,m){const g=(0,a.g2)("mdui-top-app-bar-title"),p=(0,a.g2)("mdui-button-icon"),f=(0,a.g2)("mdui-tooltip"),h=(0,a.g2)("mdui-top-app-bar"),v=(0,a.g2)("mdui-navigation-rail-item"),k=(0,a.g2)("mdui-navigation-rail"),b=(0,a.g2)("mdui-table-fluid"),y=(0,a.g2)("mdui-container"),E=(0,a.g2)("mdui-segmented-button"),B=(0,a.g2)("mdui-segmented-button-group"),w=(0,a.g2)("mdui-button"),L=(0,a.g2)("mdui-dialog");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)(h,{"scroll-behavior":"elevate",style:{"background-color":"rgba(var(--mdui-color-primary-container, 0.8))"}},{default:(0,a.k6)((()=>[o,i,(0,a.bF)(g,null,{default:(0,a.k6)((()=>[(0,a.eW)("素材列表")])),_:1}),(0,a.bF)(f,{content:"上传素材"},{default:(0,a.k6)((()=>[(0,a.bF)(p,{variant:"filled",icon:"arrow_upward",id:"uploadBtn",title:"上传素材"})])),_:1}),l,r,(0,a.bF)(f,{content:"刷新列表"},{default:(0,a.k6)((()=>[(0,a.bF)(p,{variant:"filled",icon:"refresh",id:"refreshBtn"})])),_:1})])),_:1}),(0,a.bF)(k,{divider:"","padding-left":"",id:"rail",value:"material"},{default:(0,a.k6)((()=>[(0,a.bF)(v,{icon:"videocam",id:"streamBtn",value:"stream"},{default:(0,a.k6)((()=>[(0,a.eW)("推流")])),_:1}),(0,a.bF)(v,{icon:"topic",id:"materialBtn",value:"material"},{default:(0,a.k6)((()=>[(0,a.eW)("素材")])),_:1}),(0,a.bF)(v,{icon:"help_center",href:"https://www.yuque.com/seeds-ejjgd/py7vim",target:"_blank",id:"groupBtn",value:"help"},{default:(0,a.k6)((()=>[(0,a.eW)("教程")])),_:1}),(0,a.bF)(v,{icon:"group",href:"https://qm.qq.com/q/hpYH0xIsuY",target:"_blank",id:"groupBtn",value:"group"},{default:(0,a.k6)((()=>[(0,a.eW)("加群")])),_:1}),(0,a.bF)(v,{icon:"local_fire_department",href:"https://www.beishaoidc.cn/aff/TKYYFUGE",target:"_blank",id:"adv",value:"adv"},{default:(0,a.k6)((()=>[(0,a.eW)("北少云")])),_:1}),(0,a.bF)(v,{slot:"bottom",icon:"logout",id:"logoutBtn",value:"logout"},{default:(0,a.k6)((()=>[(0,a.eW)("登出")])),_:1})])),_:1}),(0,a.bF)(y,{class:"mdui-m-t-2"},{default:(0,a.k6)((()=>[(0,a.bF)(b,null,{default:(0,a.k6)((()=>[d])),_:1})])),_:1}),(0,a.bF)(B,{"full-width":""},{default:(0,a.k6)((()=>[(0,a.bF)(E,{icon:"arrow_backward",id:"lastPageBtn"}),(0,a.bF)(E,{id:"pageText"},{default:(0,a.k6)((()=>[(0,a.eW)("第1页，共1页")])),_:1}),(0,a.bF)(E,{"end-icon":"arrow_forward",id:"nextPageBtn"})])),_:1}),(0,a.bF)(L,{id:"deleteDialog","close-on-overlay-click":"",headline:"确认删除素材?",class:"example-action"},{default:(0,a.k6)((()=>[(0,a.bF)(w,{slot:"action",variant:"text",id:"dialogCancelBtn"},{default:(0,a.k6)((()=>[(0,a.eW)("取消")])),_:1}),(0,a.bF)(w,{slot:"action",variant:"tonal",id:"dialogConfirmBtn"},{default:(0,a.k6)((()=>[(0,a.eW)("删除")])),_:1})])),_:1}),(0,a.bF)(L,{id:"uploadDialog","close-on-overlay-click":"","stacked-actions":"",headline:"素材规范",class:"example-action"},{default:(0,a.k6)((()=>[c,(0,a.bF)(w,{slot:"action",variant:"tonal",id:"uploadDialogConfirmBtn"},{default:(0,a.k6)((()=>[(0,a.eW)("选择文件")])),_:1}),(0,a.bF)(w,{slot:"action",variant:"text",id:"uploadDialogHelpBtn",target:"_blank",href:"https://www.yuque.com/seeds-ejjgd/py7vim/qvvp0a5q4xfqhdld"},{default:(0,a.k6)((()=>[(0,a.eW)("教程")])),_:1}),(0,a.bF)(w,{slot:"action",variant:"text",id:"uploadDialogCancelBtn"},{default:(0,a.k6)((()=>[(0,a.eW)("取消")])),_:1})])),_:1})],64)}n(4114),n(4603),n(7566),n(8721);var s=n(1631),m=n(5324),g=n(3567),p=n(5098);let f=1;const h=8;let v=1;function k(e){document.getElementById("streamBtn").addEventListener("click",(function(){p.A.push("/stream")}));const t=document.getElementById("deleteDialog"),n=document.getElementById("dialogCancelBtn"),a=document.getElementById("dialogConfirmBtn"),o=document.getElementById("material-list-tbody");if(o.innerHTML="",e&&e.list){if(v=e.total/h,v=Math.ceil(e.total/h),0===v&&(v=1),document.getElementById("pageText").textContent="第"+f+"页，共"+v+"页",0===e.list.length)return void(o.innerHTML='<tr><td colspan="6" class="mdui-text-center">此页没有素材，请先上传</td></tr>');e.list.forEach((e=>{const i=document.createElement("tr"),l=document.createElement("td");l.textContent=e["name"],i.appendChild(l);const r=document.createElement("td");"PIC"===e.type?r.textContent="图片":r.textContent="视频",i.appendChild(r);const d=new Date(e.uploadTime).toLocaleString(),c=document.createElement("td");c.textContent=d,i.appendChild(c);const u=e.size,m=(u/1048576).toFixed(2),p=document.createElement("td");p.textContent=m+" MB",i.appendChild(p);const f=document.createElement("td");f.className="div",f.innerHTML="<mdui-chip>删除</mdui-chip>",f.addEventListener("click",(()=>{t.open=!0,t.description=e.name,n.addEventListener("click",(()=>{t.open=!1})),a.addEventListener("click",(()=>{t.open=!1;const n={id:e.id};fetch(s.F+"/material",{method:"DELETE",headers:{Authorization:"Bearer "+(0,s.A)(),"Content-Type":"application/json"},body:JSON.stringify(n)}).then((e=>{if(!e.ok)throw new Error("Network response was not ok.");return e.json()})).then((e=>{200===e.code?((0,g.o)({message:"删除成功"}),i.parentNode.removeChild(i)):(0,g.o)({message:e.msg})})).catch((e=>{console.error("There has been a problem with your fetch operation:",e)}))}))})),i.appendChild(f),o.appendChild(i)}))}else o.innerHTML='<tr><td colspan="6" class="mdui-text-center">获取推流失败，请刷新列表</td></tr>'}async function b(){try{const e=new URLSearchParams({page:f.toString(),size:h.toString()}),t=s.F+`/material?${e.toString()}`,n=await fetch(t,{headers:{Authorization:`Bearer ${(0,s.A)()}`}});return await n.json()}catch(e){return console.error("请求素材库时出错:",e),null}}function y(){b().then((e=>{e&&401===e.code?p.A.push("/?login=1"):k(e)})).catch((e=>{console.error("处理响应时出错:",e)})),(0,m.A)(),document.getElementById("lastPageBtn").addEventListener("click",(function(){f>1?(f--,E()):(0,g.o)({message:"已经到尽头啦>.<"})})),document.getElementById("nextPageBtn").addEventListener("click",(function(){v>f?(f++,E()):(0,g.o)({message:"已经到尽头啦>.<"})})),document.getElementById("logoutBtn").addEventListener("click",(function(){localStorage.removeItem("userToken"),localStorage.removeItem("userAdmin"),p.A.push("/")}));const e=document.getElementById("uploadBtn"),t=document.getElementById("uploadDialog"),n=document.getElementById("uploadDialogCancelBtn"),a=document.getElementById("uploadDialogConfirmBtn");a.addEventListener("click",(function(){o.click(),t.open=!1})),n.addEventListener("click",(function(){t.open=!1})),e.addEventListener("click",(function(){t.open=!0}));const o=document.getElementById("fileInput");o.addEventListener("change",(function(){const t=o.files[0];if(t){const n=125829120;if(t.size>n)(0,g.o)({message:"文件大小不得超过120MB"});else{(0,g.o)({message:"正在上传，请耐心等待"}),e.loading=!0;const n=new FormData;n.append("file",t),n.append("name",t.name.replace(/\s/g,"_"));const a={Authorization:`Bearer ${(0,s.A)()||"undefined"}`};fetch(s.F+"/material",{method:"POST",headers:a,body:n}).then((e=>{if(!e.ok)throw new Error("Network response was not ok.");return e.json()})).then((t=>{200===t.code?((0,g.o)({message:"上传成功"}),b().then((e=>{k(e)})).catch((e=>{console.error("处理响应时出错:",e)}))):(0,g.o)({message:t.msg}),e.loading=!1}))}}else(0,g.o)({message:"请选择要上传的文件"})}));const i=document.getElementById("refreshBtn");i.addEventListener("click",(function(){i.loading=!0,E(),i.loading=!1,(0,g.o)({message:"刷新成功"})}))}function E(){b().then((e=>{200===e.code&&k(e)}))}var B={mounted(){y()}},w=n(1241);const L=(0,w.A)(B,[["render",u]]);var _=L},6955:function(e,t,n){var a=n(2140),o=n(4901),i=n(4576),l=n(8227),r=l("toStringTag"),d=Object,c="Arguments"===i(function(){return arguments}()),u=function(e,t){try{return e[t]}catch(n){}};e.exports=a?i:function(e){var t,n,a;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=u(t=d(e),r))?n:c?i(t):"Object"===(a=i(t))&&o(t.callee)?"Arguments":a}},2140:function(e,t,n){var a=n(8227),o=a("toStringTag"),i={};i[o]="z",e.exports="[object z]"===String(i)},655:function(e,t,n){var a=n(6955),o=String;e.exports=function(e){if("Symbol"===a(e))throw new TypeError("Cannot convert a Symbol value to a string");return o(e)}},2812:function(e){var t=TypeError;e.exports=function(e,n){if(e<n)throw new t("Not enough arguments");return e}},4603:function(e,t,n){var a=n(6840),o=n(9504),i=n(655),l=n(2812),r=URLSearchParams,d=r.prototype,c=o(d.append),u=o(d["delete"]),s=o(d.forEach),m=o([].push),g=new r("a=1&a=2&b=3");g["delete"]("a",1),g["delete"]("b",void 0),g+""!=="a=2"&&a(d,"delete",(function(e){var t=arguments.length,n=t<2?void 0:arguments[1];if(t&&void 0===n)return u(this,e);var a=[];s(this,(function(e,t){m(a,{key:t,value:e})})),l(t,1);var o,r=i(e),d=i(n),g=0,p=0,f=!1,h=a.length;while(g<h)o=a[g++],f||o.key===r?(f=!0,u(this,o.key)):p++;while(p<h)o=a[p++],o.key===r&&o.value===d||c(this,o.key,o.value)}),{enumerable:!0,unsafe:!0})},7566:function(e,t,n){var a=n(6840),o=n(9504),i=n(655),l=n(2812),r=URLSearchParams,d=r.prototype,c=o(d.getAll),u=o(d.has),s=new r("a=1");!s.has("a",2)&&s.has("a",void 0)||a(d,"has",(function(e){var t=arguments.length,n=t<2?void 0:arguments[1];if(t&&void 0===n)return u(this,e);var a=c(this,e);l(t,1);var o=i(n),r=0;while(r<a.length)if(a[r++]===o)return!0;return!1}),{enumerable:!0,unsafe:!0})},8721:function(e,t,n){var a=n(3724),o=n(9504),i=n(2106),l=URLSearchParams.prototype,r=o(l.forEach);a&&!("size"in l)&&i(l,"size",{get:function(){var e=0;return r(this,(function(){e++})),e},configurable:!0,enumerable:!0})}}]);
//# sourceMappingURL=382.b6f6fef1.js.map